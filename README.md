# Journey Down the Memory Lane

A narrative-driven adventure game built in Godot where you play as a character who has awakened from a coma with no memory of their past. Through exploration, conversations with NPCs, and meaningful choices, you piece together your identity and discover who you were before the accident.

## Tech Stack

### Game Engine
- **Godot 4.5** (Forward Plus renderer)
- **GDScript** for game logic

### Backend & AI
- **Python Flask** - RESTful API server
- **Google Gemini 2.5 Flash** - AI-powered NPC dialogue generation
- **LangChain** - RAG (Retrieval-Augmented Generation) framework
- **Chroma** - Vector database for lore storage
- **Google Generative AI Embeddings** - Semantic search for game lore

### Features Overview
- AI-driven NPC conversations with dynamic dialogue
- RAG system that grounds NPC responses in game lore
- Personality trait system that evolves based on player choices
- Relationship tracking with NPCs
- Multiple explorable locations and interior scenes
- Dynamic objective/quest system
- Save/Load game functionality

## Working Features

### Core Gameplay
- ✅ **Player Movement** - Smooth 2D character movement with animations (idle, walk, directional facing)
- ✅ **Scene Management** - Seamless transitions between levels and interior scenes via door system
- ✅ **Multiple Locations** - Main level (level_1) and multiple interiors (house_1, hut_1, hut_2, old_house, shed, windmill)

### NPC System
- ✅ **AI-Powered Conversations** - Dynamic dialogue generated by Gemini AI based on NPC personas
- ✅ **RAG Integration** - NPCs have access to game lore through retrieval-augmented generation
- ✅ **Relationship System** - Track relationships with NPCs (0-100 scale) that change based on dialogue choices
- ✅ **Multiple NPCs** - Hunter, Old Man, Old Woman, Monk, Master, Villager Boy, Villager Girl, Woman NPC
- ✅ **Conversation UI** - Chat window with typewriter effect, portrait display, and relationship feedback

### Personality & Traits
- ✅ **Personality Trait System** - Five traits tracked: empathy, risk, outlook, social, temper (-1.0 to +1.0)
- ✅ **Trait Evolution** - Traits adjust based on player dialogue choices during conversations
- ✅ **Personality Questionnaire** - Initial personality setup through 5-question quiz at game start
- ✅ **Stats Screen** - Real-time display of current personality traits

### Game Systems
- ✅ **Objective Manager** - Dynamic quest system that can add objectives during conversations
- ✅ **Player Metrics** - Global singleton tracking traits, relationships, collectibles, and conversation history
- ✅ **Endgame System** - AI-generated personality summary based on final traits and relationships
- ✅ **Conversation History** - Full conversation log maintained throughout the game

### UI & Menus
- ✅ **Start Screen** - Main menu with New Game, Load Game, and Exit options
- ✅ **Loading Screen** - Scene transition screen
- ✅ **Personality Screen** - Questionnaire to set initial personality traits
- ✅ **Pause Screen** - Accessible from interior scenes, transitions to objectives screen
- ✅ **Objectives Screen** - View active quests and objectives
- ✅ **Stats Screen** - Display current personality metrics
- ✅ **Endgame Screen** - Final summary with AI-generated personality analysis

### Save/Load System
- ✅ **Save Game** - Basic save functionality that stores scene path and player state
- ✅ **Save File Management** - Auto-incrementing save slots (save_file02.json, save_file03.json, etc.)

### Backend Features
- ✅ **Flask API Server** - `/interact` endpoint for NPC conversations
- ✅ **RAG System** - Loads lore from text files, creates embeddings, and retrieves relevant context
- ✅ **Endgame Summarization** - `/summarize` endpoint for generating final personality summary
- ✅ **JSON Response Format** - Structured responses including dialogue, relationship changes, trait shifts, and new objectives

## Parts Still Needing Work

### Inventory & Items
- ❌ **Inventory System** - No UI implementation (collectibles array exists but not displayed)
- ❌ **Item Pickup System** - Pickup logic not implemented (though `add_collectible()` function exists)
- ❌ **Item Presentation** - System to present artifacts to NPCs is not implemented
- ❌ **Pickup Text Box** - Text box that appears when items are picked up (with ESC to dismiss)
- ❌ **Artifact Placement** - Items from `lore/items/artifacts.txt` need to be placed in scenes

### Game Content
- ❌ **Interior Introductions** - Text boxes for each interior scene (only house_1 has this completed)
- ❌ **Windmill Collision** - Collision boundaries for windmill scene need to be added
- ❌ **Hut 2 Collision** - Collision metrics partially complete (50% properly added, boundaries done)

### Save/Load
- ❌ **Load Game** - Load functionality exists but needs testing and UI integration
- ❌ **Player Position Saving** - Player position is not currently saved (commented out in save_data)
- ❌ **Full State Persistence** - Save system needs to include traits, relationships, and collectibles

### UI/UX
- ❌ **Player Metrics Screen** - Screen to view current stats/relationships (partially implemented)
- ❌ **Inventory UI** - Visual display of collected items
- ❌ **Objective Completion** - UI feedback when objectives are completed

### Personality System
- ⚠️ **Personality Questions Integration** - Questions exist but full integration with game start flow may need refinement

### Backend
- ⚠️ **Error Handling** - More robust error handling for API failures
- ⚠️ **Environment Setup** - Documentation for setting up GOOGLE_API_KEY and backend dependencies

## Getting Started

### Prerequisites
- Godot 4.5 or later
- Python 3.x
- Google API Key (for Gemini AI)
- Flask and LangChain dependencies (see backend requirements)

### Backend Setup
1. Navigate to the `backend/` directory
2. Install Python dependencies (Flask, langchain, chroma, google-generativeai)
3. Set `GOOGLE_API_KEY` environment variable
4. Run `python backend.py` to start the Flask server on port 5000

### Running the Game
1. Open the project in Godot 4.5
2. Ensure the backend server is running
3. Run the game from the start screen scene

## Project Structure

```
journey-down-the-memory-lane/
├── assets/              # Game assets (sprites, backgrounds, fonts)
├── backend/             # Flask API server and lore files
│   ├── backend.py       # Main Flask application
│   └── lore/            # Game lore for RAG system
├── scenes/              # Godot scenes
│   ├── characters/      # NPC and player scenes
│   ├── interior_lvl/    # Interior location scenes
│   ├── main_level/      # Main game level
│   └── main_menu_scenes/ # Menu and UI scenes
├── scripts/             # GDScript files
│   ├── player.gd        # Player controller
│   ├── npc/             # NPC interaction scripts
│   ├── main_menu/       # Menu scripts
│   └── player_global/   # Global trait management
├── playermetrics.gd     # Global player state singleton
├── objectivemanager.gd  # Quest/objective management
└── project.godot        # Godot project configuration
```

## Contributing

This project is actively in development. See `update.md` for the latest progress notes and TODO items.
